{% extends "cases/base.html" %}
{% load bootstrap %}
{% load datepicker_html %}
{% load build_prefix %}

{% block content %}
    <div class="btn-group" role="group">
        <div class="btn-group mr-2" role="group">
            <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#incidentInfo" aria-expanded="true" aria-controls="incidentInfo">
                Incident Details
            </button>
        </div>
        <div class="btn-group mr-2" role="group">
            <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#victimInfo" aria-expanded="true" aria-controls="victimInfo">
                Victim Details
            </button>
        </div>
        <div class="btn-group mr-2" role="group">
            <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#suspectInfo" aria-expanded="true" aria-controls="suspectInfo">
                Suspect Details
            </button>
        </div>
        <div class="btn-group mr-2" role="group">
            <a href="{% url 'print-report' incident.id %}">
                <button class="btn btn-primary">Print</button>
            </a>
        </div>
        <div class="btn-group mr-2" role="group" aria-label="First group">
            <a href="{% url 'manage-files' incident.id %}">
                <button class="btn btn-primary">
                    Manage Files
                </button>
            </a>
        </div>
    </div>
    <form role="form" action="{% url 'detail' incident.id %}" method="post" enctype="multipart/form-data" class="form-group">
        {{ incident_form.media }}
        {% csrf_token %}
        <!-- {{ incident_form|bootstrap }}<br> -->
        <h4>Incident Details</h4>
        <div class="form-group collapse show" id="incidentInfo">
            {% for field in incident_form %}
                <div class="fieldWrapper">
                    {% if "datetime" in field.name %}
                        {{ field.label_tag }}
                        {% autoescape off %}{{ field|datepicker_html }}{% endautoescape %}
                    {% else %}
                        {{ field|bootstrap }}
                    {% endif %}
                </div>
            {% endfor %}

        Existing Files:
        <ul>
        {% for inc_file in existing_files %}
            <li>{{ inc_file.file.name }}</li>
        {% endfor %}
        </ul>

        </div>
        <h4>Victim Details</h4>
        <div class="form-group collapse" id="victimInfo">
            {% for victim_form in victim_forms %}
                <h4>Victim {{ forloop.counter }}</h4>
                {% with prefix="victims"|build_prefix:forloop.counter0 %}
                    <!-- {{ victim_form|bootstrap }} -->
                    {% for field in victim_form %}
                        <div class="fieldWrapper">
                            {{ field.label_tag }}
                            {% if "date_of_birth" in field.name %}
                                {% autoescape off %}
                                {{ field|datepicker_html:prefix }}
                                {% endautoescape %}
                            {% else %}
                                {{ field }}
                            {% endif %}
                        </div>
                    {% endfor %}
                {% endwith %}
            {% endfor %}
        </div>
        <h4>Suspect Details</h4>
        <div class="form-group collapse" id="suspectInfo">
            {% for suspect_form in suspect_forms %}
                <h4>Suspect {{ forloop.counter }}</h4>
                {% with prefix="suspects"|build_prefix:forloop.counter0 %}
                    <!-- {{ suspect_form|bootstrap }} -->
                    {% for field in suspect_form %}
                        <div class="fieldWrapper">
                            {{ field.label_tag }}
                            {% if "date_of_birth" in field.name %}
                                {% autoescape off %}
                                {{ field|datepicker_html:prefix }}
                                {% endautoescape %}
                            {% else %}
                                {{ field }}
                            {% endif %}
                        </div>
                    {% endfor %}
                {% endwith %}
            {% endfor %}
        </div>
        <div class="form-group">
            <button type="submit" class="btn btn-primary">Update</button>
        </div>
    </form>
{% endblock %}